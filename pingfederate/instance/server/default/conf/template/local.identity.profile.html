<!doctype html>
#set( $messageKeyPrefix = "local.identity.registration." )

<html lang="$locale.getLanguage()" dir="ltr">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <base href="$CurrentPingFedBaseURL"/>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <link rel="stylesheet" href="assets/css/styles.css">
    <link rel="stylesheet" href="assets/css/register.css">

    <title>$templateMessages.getMessage($messageKeyPrefix, "title")</title>
  </head>
  <body>
    <div class="card card-register">
      <div class="card-header">
        <a href="/" class="btn btn-link btn-back">Back</a>
        <img src="assets/images/logo.svg" class="logo" />
      </div>

     

      <div class="card-body">
        <form method="POST" action="$url" autocomplete="off">
          <h4>Manage Your Profile</h4>
          #if($messages)
          <div data-id="messages" class="page-messages full">
              #foreach ($message in $messages.getBannerMessages())
              <div class="message show $message.getCssString()">
                  $templateMessages.getMessage($message.getMessageKey(), $message.getParams())<a class="close"></a>
              </div>
              #end
          </div>
          
          #end
  
          <div class="ping-messages">
            #if($messages)
                #foreach ($errorMessage in $messages.getStandardMessages())
                    <div class="ping-error">
                        $templateMessages.getMessage($errorMessage.getMessageKey(), $errorMessage.getParams())
                    </div>
                #end
            #end
            
        </div>
        <div class="ping-messages">
            <div class="ping-error" style="display:none" id="required-field-error">
                <span class="icon-alert"></span>
                $templateMessages.getMessage($messageKeyPrefix, "required.fields.missing")
            </div>
            
        </div>

         
          <div class="form-row-light form-row">
            <div class="col-md-6">
              <div class="form-group"><label for="account_number" class="">Account Number</label><input name="bxFinanceUserAccountNumber" id="bxFinanceUserAccountNumber" placeholder="Account Number" type="text" class="form-control" /></div>
            </div>
            <div class="col-md-6">
              <div class="form-group"><label for="username" class="">Username</label><input name="username" id="username" placeholder="Username" type="text" class="form-control" /></div>
            </div>
          </div>
          <div class="form-row-light form-row">
            <div class="col-md-6">
              <div class="form-group"><label for="firstname" class="">First Name</label><input name="firstName" id="firstName" placeholder="First Name" type="text" class="form-control" /></div>
            </div>
            <div class="col-md-6">
              <div class="form-group"><label for="lastname" class="">Last Name</label><input name="lastName" id="lastName" placeholder="Last Name" type="text" class="form-control" /></div>
            </div>
          </div>
          <div class="form-row-light form-row">
            <div class="col-md-6">
              <div class="form-group"><label class="">Preferred Name</label><input name="fullName" id="fullName" placeholder="Preferred Name" type="text" class="form-control" /></div>
            </div>
            <div class="col-md-6">
                <div class="form-group"><label class="">Middle Initial</label><input name="initials" id="initials" placeholder="Middle Initial" type="text" class="form-control" /></div>
              </div>
          </div>
          <div class="form-row-light form-row">
            <div class="col-md-6">
              <div class="form-group"><label for="email" class="">Email Address</label><input name="email" id="email" placeholder="Email" type="email" class="form-control" /></div>
            </div>
            <div class="col-md-6">
              <div class="form-group"><label for="phone" class="">Phone Number</label><input name="phoneNumber" id="phoneNumber" placeholder="(555) 555-5555" type="tel" class="form-control" /></div>
            </div>
          </div>

          <div class="form-row-light form-row">
            <div class="col-md-6">
                <div class="form-group"><label class="">Street</label><input name="street" id="street" placeholder="123 Street" type="text" class="form-control" /></div>
              </div>
              <div class="col-md-6">
                <div class="form-group"><label class="">City</label><input name="city" id="city" placeholder="City" type="text" class="form-control" /></div>
              </div>
          </div>

          <div class="form-row-light form-row">
            <div class="col-md-6">
                <div class="form-group"><label class="">Zip</label><input name="zip" id="zip" placeholder="12345" type="text" class="form-control" /></div>
              </div>
              <div class="col-md-6">
                <div class="form-group"><label class="">Birth Date</label><input name="birthDate" id="birthDate" placeholder="MM-DD-YYYY" type="text" class="form-control" /></div>
              </div>
          </div>

          <div class="form-row-login form-row">
            <div class="col-md-6">
              <div class="form-group mb-0">
                <label for="login" class="text-dark">
                  What is your Household Income? <br>
                  <img src="assets/images/icon-info.svg" class="icon-info" />
                </label>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group mb-0">
                <select name="householdIncome" id="householdIncome" class="form-control">
                  <option>Choose One from Below</option>
                  <option value="Less than $100,000">Less than $100,000</option>
                  <option value="$100,000 - $300,000 ">$100,000 - $300,000</option>
                  <option value="$300,000 - $500,000 ">$300,000 - $500,000 </option>
                  <option value="Greater than $500,000">Greater than $500,000</option>
                </select>
              </div>
            </div>
          </div>
          
          <div class="form-row-login form-row">
            <div class="col-md-6">
              <div class="form-group mb-0">
                <label for="login" class="text-dark">
                  How would you like to sign in? <br>
                  <img src="assets/images/icon-info.svg" class="icon-info" />
                </label>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group mb-0">
                <select name="authnPreferences" id="authnPreferences" class="form-control">
                  <option>Choose your Method</option>
                  <option value="Device">With my Mobile Device or One-Time Password</option>
                  <option value="Password">With my Password</option>
                </select>
              </div>
            </div>
          </div>

          <div class="content-column">
            <div class="section">
                <div class="section-title">
                    $templateMessages.getMessage($messageKeyPrefix, "accountSettingsTitle")
                </div>

                #if($hasLocalIdentity)
                <div class="your-account-container">
                    <input type="hidden" name="$changepass" value=""/>
                    ##Pop up the tooltip if there is an error message to show.
                    #if($passwordMessage)
                        #if($socialConnections.size() > 0)
                            #set( $class = "details-tooltip top center show" )
                        #else
                            #set( $class = "details-tooltip top right show" )
                        #end
                    #else
                        #if($socialConnections.size() > 0)
                            #set( $class = "details-tooltip top center" )
                        #else
                            #set( $class = "details-tooltip top right" )
                        #end
                    #end

                    <span class="$class">
                            <a onclick="showTooltip(this); focusCurrentPasswordField();" class="cancel" title="$templateMessages.getMessage($messageKeyPrefix, "changePasswordTitle")">
                                $templateMessages.getMessage($messageKeyPrefix, "changePasswordTitle")
                        </a>
                        <div class="details-content" id="change-password-tooltip">
                                <div class="details-content-inner">
                                    <span class="details-close" onclick="hideTooltip()">

                                    </span>
                                    <div class="details-title">
                                        $templateMessages.getMessage($messageKeyPrefix, "changePasswordTitle")
                                    </div>
                                    <div class="details-body">
                                        #if($passwordMessage)
                                        <div class="ping-messages">
                                            <div class="ping-error">$templateMessages.getMessage($passwordMessage.getMessageKey(), $passwordMessage.getParams())</div>
                                        </div>
                                        #end

                                        <span class="ping-messages" style="display:none" id="required-password-field-error">
                                            <div class="ping-error">
                                                <span class="icon-alert"></span>
                                                $templateMessages.getMessage($messageKeyPrefix, "required.fields.missing")
                                            </div>
                                        </span>

                                        <div class="ping-input-label" style="font-family:Rubik;">
                                            $templateMessages.getMessage($messageKeyPrefix, "currentPasswordTitle")
                                        </div>
                                        <div class="ping-input-container required" id="container-currentPassword" style="font-family:Rubik;">
                                            <input id="currentPassword" class="pass-required" type="password" name="$currentPass" autocomplete="off" onKeyUp="return postChangePassOnReturn(event)" />
                                        </div>

                                        #set( $passwordRequirementOne = $templateMessages.getMessageWithDefault($messageKeyPrefix, "passwordRequirementOne", "") )
                                        #set( $passwordRequirementTwo =  $templateMessages.getMessageWithDefault($messageKeyPrefix, "passwordRequirementTwo", "") )
                                        #set( $passwordRequirementThree =  $templateMessages.getMessageWithDefault($messageKeyPrefix, "passwordRequirementThree", "") )
                                        #set( $passwordRequirementFour =  $templateMessages.getMessageWithDefault($messageKeyPrefix, "passwordRequirementFour", "") )
                                        #if( $passwordRequirementOne && $passwordRequirementOne.trim() != "" ||
                                                $passwordRequirementTwo && $passwordRequirementTwo.trim() != "" ||
                                                $passwordRequirementThree && $passwordRequirementThree.trim() != "" ||
                                                $passwordRequirementFour && $passwordRequirementFour.trim() != "")
                                            #set( $isShowPasswordRequirements = true )
                                        #else
                                            #set( $isShowPasswordRequirements = false )
                                        #end

                                        #if( $isShowPasswordRequirements )
                                        <div class="ping-input-container">
                                            <div class="place-top type-requirements requirements tooltip-text" id="password-requirements">
                                                <div class="title" onclick="showHideRequirements();">
                                                    $templateMessages.getMessage($messageKeyPrefix, "passwordRequirementTitle")
                                                </div>
                                                <div class="requirements-text">
                                                    <div class="requirements-contain">
                                                        $templateMessages.getMessage($messageKeyPrefix, "passwordRequirementsContain")
                                                    </div>
                                                    #if( $passwordRequirementOne && $passwordRequirementOne.trim() != "" )
                                                    <div>
                                                        $templateMessages.getMessage($messageKeyPrefix, "passwordRequirementOne")
                                                    </div>
                                                    #end
                                                    #if( $passwordRequirementTwo && $passwordRequirementTwo.trim() != "" )
                                                    <div>
                                                        $templateMessages.getMessage($messageKeyPrefix, "passwordRequirementTwo")
                                                    </div>
                                                    #end
                                                    #if( $passwordRequirementThree && $passwordRequirementThree.trim() != "" )
                                                    <div>
                                                        $templateMessages.getMessage($messageKeyPrefix, "passwordRequirementThree")
                                                    </div>
                                                    #end
                                                    #if( $passwordRequirementFour && $passwordRequirementFour.trim() != "" )
                                                    <div>
                                                        $templateMessages.getMessage($messageKeyPrefix, "passwordRequirementFour")
                                                    </div>
                                                    #end
                                                </div>
                                            </div>
                                        </div>
                                        #end

                                        <div class="ping-input-label" style="font-family:Rubik;">
                                            $templateMessages.getMessage($messageKeyPrefix, "newPasswordTitle")
                                        </div>
                                        <div class="ping-input-container required" id="container-password">
                                            <input id="password" class="pass-required reveal" type="password" name="$pass" autocomplete="user-password" onKeyUp="return postChangePassOnReturn(event)" />
                                            <a id="reveal" class="password-show-button icon-view" onclick="revealPassword();"></a>
                                        </div>
                                        <div class="button-group">
                                            <button type="button" onclick="return postChangePass();" class="primary" style="background-color:#67c5b1; font-family:Rubik;">$templateMessages.getMessage($messageKeyPrefix, "changePasswordButtonTitle")</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </span>
                </div>
                <!-- your-account-container -->
                #end

                #if(!$hasLocalIdentity)
                <div class="your-account-container">
                    <input type="hidden" name="$setpass" value=""/>
                    ##Pop up the tooltip if there is an error message to show.
                    #if($passwordMessage)
                    #if($socialConnections.size() > 0)
                    #set( $class = "details-tooltip top center show" )
                    #else
                    #set( $class = "details-tooltip top right show" )
                    #end
                    #else
                    #if($socialConnections.size() > 0)
                    #set( $class = "details-tooltip top center" )
                    #else
                    #set( $class = "details-tooltip top right" )
                    #end
                    #end

                    <span class="$class">
                            <a onclick="showTooltip(this); focusNewPasswordField();" class="cancel" title="$templateMessages.getMessage($messageKeyPrefix, "setPasswordTitle")">
                                $templateMessages.getMessage($messageKeyPrefix, "setPasswordTitle")
                        </a>
                        <div class="details-content" id="change-password-tooltip">
                                <div class="details-content-inner">
                                    <span class="details-close" onclick="hideTooltip()">

                                    </span>
                                    <div class="details-title" style="font-family:Rubik;">
                                        $templateMessages.getMessage($messageKeyPrefix, "setPasswordTitle")
                                    </div>
                                    <div class="details-body" style="font-family:Rubik;">
                                        #if($passwordMessage)
                                        <div class="ping-messages">
                                            <div class="ping-error">$templateMessages.getMessage($passwordMessage.getMessageKey(), $passwordMessage.getParams())</div>
                                        </div>
                                        #end

                                        <span class="ping-messages" style="display:none" id="required-password-field-error">
                                            <div class="ping-error">
                                                <span class="icon-alert"></span>
                                                $templateMessages.getMessage($messageKeyPrefix, "required.fields.missing")
                                            </div>
                                        </span>

                                        #set( $passwordRequirementOne = $templateMessages.getMessageWithDefault($messageKeyPrefix, "passwordRequirementOne", "") )
                                        #set( $passwordRequirementTwo =  $templateMessages.getMessageWithDefault($messageKeyPrefix, "passwordRequirementTwo", "") )
                                        #set( $passwordRequirementThree =  $templateMessages.getMessageWithDefault($messageKeyPrefix, "passwordRequirementThree", "") )
                                        #set( $passwordRequirementFour =  $templateMessages.getMessageWithDefault($messageKeyPrefix, "passwordRequirementFour", "") )
                                        #if( $passwordRequirementOne && $passwordRequirementOne.trim() != "" ||
                                                $passwordRequirementTwo && $passwordRequirementTwo.trim() != "" ||
                                                $passwordRequirementThree && $passwordRequirementThree.trim() != "" ||
                                                $passwordRequirementFour && $passwordRequirementFour.trim() != "")
                                            #set( $isShowPasswordRequirements = true )
                                        #else
                                            #set( $isShowPasswordRequirements = false )
                                        #end

                                        #if( $isShowPasswordRequirements )
                                        <div class="ping-input-container">
                                            <div class="place-top no-border type-requirements requirements tooltip-text" id="password-requirements">
                                                <div class="title" onclick="showHideRequirements();">
                                                    $templateMessages.getMessage($messageKeyPrefix, "passwordRequirementTitle")
                                                </div>
                                                <div class="requirements-text">
                                                    <div class="requirements-contain">
                                                        $templateMessages.getMessage($messageKeyPrefix, "passwordRequirementsContain")
                                                    </div>
                                                    #if( $passwordRequirementOne && $passwordRequirementOne.trim() != "" )
                                                    <div>
                                                        $templateMessages.getMessage($messageKeyPrefix, "passwordRequirementOne")
                                                    </div>
                                                    #end
                                                    #if( $passwordRequirementTwo && $passwordRequirementTwo.trim() != "" )
                                                    <div>
                                                        $templateMessages.getMessage($messageKeyPrefix, "passwordRequirementTwo")
                                                    </div>
                                                    #end
                                                    #if( $passwordRequirementThree && $passwordRequirementThree.trim() != "" )
                                                    <div>
                                                        $templateMessages.getMessage($messageKeyPrefix, "passwordRequirementThree")
                                                    </div>
                                                    #end
                                                    #if( $passwordRequirementFour && $passwordRequirementFour.trim() != "" )
                                                    <div>
                                                        $templateMessages.getMessage($messageKeyPrefix, "passwordRequirementFour")
                                                    </div>
                                                    #end
                                                </div>
                                            </div>
                                        </div>
                                        #end

                                        <div class="ping-input-label">
                                            $templateMessages.getMessage($messageKeyPrefix, "newPasswordTitle")
                                        </div>
                                        <div class="ping-input-container required" id="container-password">
                                            <input id="password" class="pass-required reveal" type="password" name="$pass" autocomplete="user-password" onKeyUp="return postSetPassOnReturn(event)" />
                                            <a id="reveal" class="password-show-button icon-view" onclick="revealPassword();"></a>
                                        </div>
                                        <div class="button-group">
                                            <button type="button" onclick="return postSetPass();" class="primary" style="background-color:#67c5b1;"> $templateMessages.getMessage($messageKeyPrefix, "setPasswordButtonTitle")</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </span>
                </div>
                #end

                #if($displayDelete)
                <div class="your-account-container">

                    #if($socialConnections.size() > 0)
                        #set( $tooltipClass = "details-tooltip top center" )
                    #else
                        #set( $tooltipClass = "details-tooltip top right" )
                    #end

                        <span class="$tooltipClass">

                            <a href="javascript:void(0)" onclick="showTooltip(this)" class="cancel" title='$templateMessages.getMessage($messageKeyPrefix, "deleteAccountPopupTitle")'>
                            $templateMessages.getMessage($messageKeyPrefix, "deleteAccountPopupTitle")
                            </a>
                            <div class="details-content">
                                <div class="details-content-inner">
                                    <span class="details-close" onclick="hideTooltip()">

                                    </span>
                                    <div class="details-title">
                                        $templateMessages.getMessage($messageKeyPrefix, "deleteAccountButtonTitle")
                                    </div>
                                    <div class="details-body">
                                        <p>$templateMessages.getMessage($messageKeyPrefix, "deleteWarning")</p>
                                        <div class="button-group">
                                            <button type="button" onclick="postDelete();" class="primary delete">$templateMessages.getMessage($messageKeyPrefix, "deleteButtonTitle")</button>
                                            <br>
                                            <a class="cancel" onclick="hideTooltip();">$templateMessages.getMessage($messageKeyPrefix, "cancelButtonTitle")</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </span>
                </div>
                #end
                <!-- end display-delete -->
            </div>

        </div>


          <div class="ping-buttons" style="margin:0 auto; font-family:Rubik;">
            <input type="hidden" name="$ok" value=""/>
            <input type="hidden" name="$cancel" value=""/>
            <input type="hidden" name="$signOn" value=""/>
            <input type="hidden" id="field" name="field">

            <div class="form-row-light form-row">

                <button type="submit" onclick="postOk();" class="btn btn-primary">
                    Submit
                </button>
                
                &nbsp;&nbsp;&nbsp;

                <a href="javascript:void(0)" onclick="postCancel();" class="btn btn-link ml-3">
                    Cancel
                </a>
            </div>

        </div>

        </form>
      </div>
    </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
  
    <script type="text/javascript">

      function showHideRequirements() {
          var tips = document.getElementById('password-requirements');
  
          if (tips.style.display == "none") {
                  tips.style.display = "block";
                    if (tips.className.search(/\bopen\b/) === -1) {
                        tips.className += ' open';
                    }
                    else {
                        tips.className = tips.className.replace(/\bopen\b/,'');
                    }
                  }
                  
      }
  
      function submitForm()
      {
          document.forms[0]['$ok'].value = 'clicked';
          document.forms[0].submit();
          if($captchaEnabled) {
              grecaptcha.reset();
          }
      }
  
      function postThirdPartyRegister(system) {
          var variants = ["Biometrics", "Windows Hello", "Face ID",  "Touch ID"];
        if(variants.indexOf(system) >= 0) system = "FIDO";
          document.forms[0]['$alternateThirdPartyRegister'].value = system;
          document.forms[0].submit();
      }
  
      function postCancel() {
          document.forms[0]['$cancel'].value = 'clicked';
          document.forms[0].submit();
      }
      function postSignOn() {
          document.forms[0]['$signOn'].value = 'clicked';
          document.forms[0].submit();
      }
  
      function postOk() {
          if (!requiredFieldsMissing()) {
              if ($captchaEnabled) {
                  grecaptcha.execute();
              }
              else {
                  // run browser validation
                  if(document.forms[0].checkValidity && !document.forms[0].checkValidity() && document.forms[0].reportValidity) {
                      document.forms[0].reportValidity();
                      return false;
                  }
                  submitForm();
              }
          }
      }
  
      function revealPassword() {
          var inputType = document.getElementById("password");
  
          if (document.getElementById('password').type === 'password') {
              inputType.setAttribute('type', 'text');
              document.getElementById('reveal').className = 'password-show-button icon-view-hidden';
          }
          else {
              inputType.setAttribute('type', 'password');
              document.getElementById('reveal').className = 'password-show-button icon-view';
          }
      }
  
      function requiredFieldsMissing() {
          var requiredFields = document.querySelectorAll("input.required,select.required");
          var foundMissingField = false;
  
          for (var i = 0; i < requiredFields.length; i++) {
              var field = requiredFields[i];
              if (field.type === "checkbox")
                  foundMissingField = isCheckBoxFieldMissing(field) || foundMissingField;
              else if (field.tagName === 'SELECT')
                  foundMissingField = isSelectFieldMissing(field) || foundMissingField;
              else
                  foundMissingField = isStandardFieldMissing(field) || foundMissingField;
          }
  
          if (foundMissingField) {
              var element = document.getElementById("required-field-error");
              element.style.display = "block";
              window.scroll(0, element.offsetTop);
          }
          else {
              document.getElementById("required-field-error").style.display = "none";
          }
          return foundMissingField;
      }
  
      function isCheckBoxFieldMissing(field) {
          var checkboxes = document.getElementsByName(field.name);
  
          var foundChecked = false;
          for (var i = 0; i < checkboxes.length; i++) {
              if(checkboxes[i].checked) {
                  foundChecked = true;
              }
          }
  
          if (!foundChecked) {
              // Use the name if no id is provided (for check box groups)
              var errorField = document.getElementById("required-" + checkboxes[0].name);
              errorField.classList.add("show");
          }
  
          return !foundChecked;
      }
  
      function hideCheckboxRequired(field) {
          var id = field.name;
          var requiredDisplay  = document.getElementById("required-" + id);
          requiredDisplay.classList.remove("show");
      }
  
      function isSelectFieldMissing(field) {
          if (field.tagName === 'SELECT' && field.selectedIndex === 0 && field.options[0].disabled) {
              showErrorDisplay(field);
              return true;
          }
          return false;
      }
  
      function isStandardFieldMissing(field){
          if (!field.value) {
              showErrorDisplay(field);
              return true;
          }
          return false;
      }
  
      function showErrorDisplay(field) {
          var container = document.getElementById("container-" + field.id);
          container.classList.add("error");
          container.classList.add("form-error");
          container.classList.add("required");
      }
  
      function showRequiredDisplay(field) {
          var container = document.getElementById("container-" + field.id);
          container.classList.add("required");
      }
  
      function removeRequiredDisplay(field) {
          var container = document.getElementById("container-" + field.id);
          container.classList.remove("error");
          container.classList.remove("form-error");
          container.classList.remove("required");
      }
  
      function toggleRequiredDisplay(field) {
          if (!field.value || field.value === "")
              showRequiredDisplay(field);
          else
              removeRequiredDisplay(field);
      }
  
      function postOnReturn(e) {
          var keycode;
          if (window.event) keycode = window.event.keyCode;
          else if (e) keycode = e.which;
          else return true;
  
          if (keycode == 13) {
              postOk();
              return false;
          } else {
              return true;
          }
      }
  
      function setMobile(mobile, agent) {
          var className = ' mobile',
              agentClass = agent,
              hasClass = (bodyTag.className.indexOf(className) !== -1),
              hasAgent = (bodyTag.className.indexOf(agentClass) !== -1);
  
          if (mobile && !hasClass) {
              bodyTag.className += className;
              bodyTag.className += agentClass;
          } else if (!mobile && hasClass) {
              bodyTag.className = bodyTag.className.replace(className, '');
          } else if (!mobile && hasAgent) {
              bodyTag.className = bodyTag.className.replace(agentClass, '');
          }
  
          <!-- Check if this is the PingOne Mobile App -->
          #if($HttpServletRequest.getHeader('X-Ping-Client-Version'))
              if (mobile) {
                  bodyTag.className += ' embedded';
              }
          #end
      }
  
      function getScreenWidth() {
          return (window.outerHeight) ? window.outerWidth : document.body.clientWidth;
      }
  
      function setFocus() {
          if (document.forms[0]) {
              for (i = 0; i < document.forms[0].elements.length; i++) {
                  var element = document.forms[0].elements[i];
                  if (element.type != "hidden" && element.disabled !== true && (element.value == null || element.value === "")) {
                      element.focus({});
                      return;
                  }
              }
          }
      }
  
      var bodyTag = document.getElementsByTagName('body')[0],
          width = getScreenWidth(),
          userAgent = '';
      if (navigator.userAgent.match(/android/i)) {
          userAgent = ' device-android';
      }
  
      #if($altAuthSources.size() > 0 && $isLocalRegistration)
          bodyTag.className += 'columns-layout';
      #end
  
      if (/Android|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
          setMobile(true, userAgent);
      } else {
          setMobile((width <= 480), userAgent);
          window.onresize = function() {
              width = getScreenWidth();
              setMobile((width <= 480), userAgent);
          }
      }
  
      const requiredElements = document.forms[0].querySelectorAll('.required-missing-display');
      for (i = 0; i < requiredElements.length; i++) {
          var requiredElement = requiredElements[i];
          requiredElement.addEventListener('keyup', function (event) {
              toggleRequiredDisplay(event.target);
          });
          requiredElement.addEventListener('change', function (event) {
              toggleRequiredDisplay(event.target);
          });
  
          // Remove required markers for fields that have been filled in.
          if (requiredElement.tagName === 'SELECT') {
              if(requiredElement.tagName === 'SELECT' && requiredElement.selectedIndex !== 0 && !requiredElement.options[0].disabled)
                  removeRequiredDisplay(requiredElement);
          } else {
              if(requiredElement.value) {
                  removeRequiredDisplay(requiredElement);
              }
          }
      }
  
      var passwordField = document.getElementById("password");
      if(passwordField){
          passwordField.addEventListener('keyup', function (event) {
              toggleRequiredDisplay(event.target);
          });
          passwordField.addEventListener('change', function (event) {
              toggleRequiredDisplay(event.target);
          })
      }
  
      const messages = document.querySelectorAll('.page-messages .message');
  
      // hide messages after 5 seconds.
      for (i = 0; i < messages.length; i++) {
          setInterval(function() {
              messages[0].style.display = 'none';
          }, 5000);
      }
  
      const closebuttons = document.querySelectorAll('.page-messages .message > a.close');
      // Attach listener to remove message when close button is clicked.
      for (i = 0; i < closebuttons.length; i++) {
          var element = closebuttons[i];
          element.addEventListener('click', function (event) {
              var messagediv = event.target.parentNode;
              messagediv.parentNode.removeChild(messagediv);
          })
      }
  
      window.addEventListener('load', function() {
          document.body.style.display = "block";
          // set first field focus
          setFocus();
      });
  
      function IsWebAuthnSupported() {
          if (!window.PublicKeyCredential) {
  
              console.log("Web Authentication API is not supported on this browser.");
              return false;
          }
  
          return true;
      }
  
       function isWebAuthnPlatformAuthenticatorAvailable() {
  
          theElement = document.getElementById("biometrics-div");
          if(theElement)
              theElement.style.display = "none";
  
          theElement = document.getElementById("windowshello-div");
          if(theElement)
               theElement.style.display = "none";
  
          theElement = document.getElementById("faceid-div");
          if(theElement)
              theElement.style.display = "none";
  
          theElement = document.getElementById("touchid-div");
          if(theElement)
              theElement.style.display = "none";
  
          // skip the WebAuthn support check on Internet Explorer as both WebAuthn and Promise are not supported on IE
          var ua = window.navigator.userAgent;
          var msie = ua.indexOf("MSIE ");
          if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./)) {
              return false;
          }
  
          var timer;
  
          var p1 = new Promise(function(resolve) {
              timer = setTimeout(function() {
                  console.log("isWebAuthnPlatformAuthenticatorAvailable - Timeout");
                  resolve(false);
              }, 300);
          });
  
          var p2 = new Promise(function(resolve) {
  
              if (IsWebAuthnSupported() && window.PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable) {
  
                  resolve(
                      window.PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable().catch(function(err) {
                          console.log(err);
                          return false;
                      }));
              }
              else {
                  resolve(false);
              }
          });
  
          return Promise.race([p1, p2]).then(function (res) {
              clearTimeout(timer);
              console.log("isWebAuthnPlatformAuthenticatorAvailable - " +  res);
  
              if(res) {
                   theElement = document.getElementById("biometrics-div");
                   if(theElement)
                       theElement.style.display = "block";
  
                   theElement = document.getElementById("windowshello-div");
                   if(theElement)
                       theElement.style.display = "block";
  
                   theElement = document.getElementById("faceid-div");
                   if(theElement)
                       theElement.style.display = "block";
  
                   theElement = document.getElementById("touchid-div");
                   if(theElement)
                       theElement.style.display = "block";
              }
  
              return res;
          });
      }
  </script>
  </body>
</html>